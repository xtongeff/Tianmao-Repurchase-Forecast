

# 项目背景
    商家常在 “双十一” 等促销节点吸引消费者，但难以识别具有复购潜力的用户。该项目基于匿名用户 “双十一” 前 6 个月及 “双十一” 当天购物记录，需预测新客未来 6 个月复购概率。
# 解决方案：
    特征工程：新增了店铺、品类、活跃天数、用户行为等共20个特征。
    预测：分别使用LR，决策树，随机森林，Adaboost，GBDT，lgb，XGBoost进行复购率预测，AUC最优达到0.625。
    优化：进行特征优化和模型调参后，最终使用表现最好的XGBoost进行复购率预测，测试集上AUC达到0.658。
# 项目痛点：
    原数据正负样本比例约15:1，正样本少。用SMOTE算法过采样后，Train AUC达到0.980，Test AUC达到0.974，但有过拟合风险，未用于生成预测文件。 
    特征选择前，使用XGBoost进行预测的Test AUC 为 0.628。用SelectKBest从23个特征筛选到2个最佳特征后，Test AUC提升到 0.658，表明特征选择能避免模型因冗余特征过多而出现过拟合。
# 项目细节
    天猫复购预测项目，涵盖了数据处理与可视化、特征工程、模型训练与调参、结果评估等多环节。
      1.	数据可视化
        o	正负样由重复买家和非重复买家构成，展示它们的数量分布，大约15:1：正负样本不均衡，非重复买家 244912 个，重复买家 15952 个。
        o	其次，分析了店铺购买情况：展示购买次数前 5 的店铺， 
        o	复购概率计算：按user_id分组，计算每组平均label值得到复购概率，并筛选出 0 - 1 之间的有效概率值。
        o	性别、年龄与复购分布：分析不同性别、年龄区间与复购的关系，可视化展示分布情况。
        o	不同时间段复购用户数量：统计不同时间戳和月份的复购用户数量，存在同一用户多次购买的情况。
      2.	特征工程
        o	数据合并与特征计算：合并train_data(标记target为1)、test_data(标记target为1)和user_info形成all_data，计算用户店铺数、不同品类个数等多种特征，还包括活跃天数方差等新特征。  
        o	找出用户偏好特征：确定用户最喜欢的店铺、类目、品牌、最常见的行为动作等，以及这些偏好项的出现次数。
        o	行为次数统计：统计点击、加购、购买、收藏等行为次数并添加到all_data。
        o	数据集划分与处理：依据target列划分训练集和测试集，删除测试集label列，用 0 填充缺失值后保存为新文件。
      3.	建模与评估
        o	多种模型训练与评估：运用LR，决策树，随机森林，Adaboost，GBDT，lgb，xgboost等多种模型进行训练，评估指标为训练集和测试集的 AUC 分数。例如逻辑回归训练集 AUC 为 0.5844858579060441，测试集为 0.5791973672278666 。
        o	LightGBM 与 XGBoost 模型：这两个模型采用特定参数设置和早停机制训练，同样计算 AUC 分数评估性能，XGBoost 还进行了调参和处理类别不平衡操作（使用 SMOTE 算法对少数类样本进行过采样，生成合成样本。选择少数类样本：从少数类中随机选择一个样本点。计算近邻：找出该样本在特征空间中的 k 个最近邻（通常 k=5）。
        ）。XGBoost ：Train AUC Score 0.7415361411819856。Test AUC Score 0.6253678428365083
      4.	调参与优化
        o	XGBoost 调参：从确定树的个数开始，对树的最大深度、最小叶子节点样本权重、gamma（树的节点分裂时，所需的最小损失减少量）、subsample（随机采样样本比例）、colsample_bytree（随机采样特征比例）、reg_alpha参数（L1 正则化系数）等多个参数进行网格搜索调参，用调整后的参数重新训练模型。 
        o	特征选择与调参结合：使用SelectKBest和mutual_info_classif进行特征选择，结合调参优化模型，最终将预测结果保存为prediction.csv，包含user_id、merchant_id和predict_prob等字段。
          以下两个特征对复购率预测影响最大：
            1. 用户最喜欢的店铺（用户偏好特征）（商家的唯一ID编码merchant_id）
            •	原因：用户对特定店铺的偏好是复购的强信号。如果用户在历史数据中频繁购买某店铺的商品，说明其对该店铺的信任度和满意度较高，未来再次购买的可能性极大。
            •	数据支持：在项目中，店铺购买情况分析显示少数店铺占据了较高的购买次数，这暗示用户存在明显的店铺偏好，而偏好往往与复购行为直接相关。
            2. action_type_unique（不用行为种数，包含{0, 1, 2, 3}，0表示单击，1表示添加到购物车，2表示购买，3表示添加到收藏夹）
            •	原因：这些行为对复购影响很大。
          最终XGBoost的Train AUC Score 0.7003899622707981，Test AUC Score 0.6577574166137921

